**Da**tabase of **t**ime **s**eries of **i**nfectious **d**iseases (Datsid)

Overview
========
This repo provides scripts that can build from scratch a SQLite database. 
The database is built from epidemiological time series (incidence, deaths, etc.) that must be saved in the _correct format_ in the `data` folder (see data/README.md). 
There are three main tables (for now) that define the relational database: one that defines the diseases (`table_disease`), one that defines the locations where the epidemic was observed (`table_location`) and finally one that records the epidemic, that is which disease was observed where (`table_epievent`). This last table is automaticaly built.
Information regarding the diseases and the geographical locations must be entered beforehand in these tables.

Structure
========

* `tables` folder with static tables (describing diseases, locations, etc.). There are also Excel spreadsheet that facilitates entering new entries in these tables. 
* `data` folder contains the `*-db.csv` files containing the epidemiological data that populates the database.
* the subfolder `data/raw-data` contains the raw data files that were either manually obtained, or downloaded directly from the internet. The file name conventions are
  * `-web.R` script to download data when possible
  * `-raw.csv` for downloaded data (either manually or with `-web.R` script)
  * `-dictionary-*.csv` is human-readable metadata (but complicated)
  * `-reformat.R` converts input csvs to final version:
	* `-db.csv` formated data ready for import into the database. These files are copied in the `data` folder.
* `sql` folder contains the SQL scripts.

__TODO__:
* Figure out how to use (and check?) table headers
* Incorporate this into make, or otherwise make transparent


Synthetic Data
==============

Synthetic epidemic time series (generated by mathematical models) can be included in the database. They have the same format as real ones. The field `synthetic` in `table_epievent` allow to distinguish real from synthetic epidemics: `synthetic=0` means a real epidemic data. `synthetic=n` means it is the nth stochastic realization of a mathematical model.

The script `gen-syndata` in `data/synthetic` generates synthetic data from a SEmInR stochastic model. The model parameters (e.g. R0, etc) need to be changed directly in the script (for now, will change that); several parameter sets can be simulated at once. The synthetic data generated (`syn-data.csv`) have the correct format, ready to be imported in the database.
Running `gen-syndata n` will generate `n` stochastic realizations for each parameter sets.

Using the database in R
=======================

The program `buildDBfromScratch.sh abc.db` will download the raw data from the internet and use the manually saved raw data to create a new database named `abc.db`. Note: `abc.db` must not already exist.

Running `glimpse abc.db` gives a summary of the data in the database `abc.db`.

